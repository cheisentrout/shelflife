generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// MODELS

model User {
  id        String   @id @default(cuid())
  clerkId   String   @unique
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  toys Toy[]
  organizedMeetups  Meetup[]          @relation("MeetupOrganizer")
  attendingMeetups  MeetupAttendee[]
}

model Toy {
  id          String   @id @default(cuid())
  
  // Basic Info
  title       String
  description String?
  brand       String?
  condition   ToyCondition
  
  // Photos
  photos      String[]
  
  // Development
  developmentalDomains  DevelopmentalDomain[]
  ageRangeMin Int
  ageRangeMax Int?
  materials   String?
  
  // Location
  zipCode     String
  city        String?
  state       String?
  latitude    Float?
  longitude   Float?
  
  // Ownership & Status
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  isAvailable Boolean  @default(true)
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Meetup {
  id            String   @id @default(cuid())
  
  // Basic Info
  title         String
  description   String?
  
  // When
  date          DateTime
  
  // Where
  locationName  String?
  address       String?
  city          String
  state         String
  zipCode       String
  latitude      Float?
  longitude     Float?
  
  // Organizer
  organizerId   String
  organizer     User            @relation("MeetupOrganizer", fields: [organizerId], references: [id], onDelete: Cascade)
  
  // Attendees
  attendees     MeetupAttendee[]
  maxAttendees  Int?
  
  // Timestamps
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model MeetupAttendee {
  id        String   @id @default(cuid())
  meetupId  String
  meetup    Meetup   @relation(fields: [meetupId], references: [id], onDelete: Cascade)
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  
  @@unique([meetupId, userId])
}

// ENUMS

enum ToyCondition {
  LIKE_NEW
  EXCELLENT
  GOOD
  FAIR
  WELL_LOVED
}

enum DevelopmentalDomain {
  FINE_MOTOR
  GROSS_MOTOR
  COGNITIVE
  LANGUAGE
  SOCIAL_EMOTIONAL
  SENSORY
  PRACTICAL_LIFE
  CREATIVE
}